version: 2.1
jobs:
  build:
    docker:
      - image: mcr.microsoft.com/dotnet/core/sdk:2.1
    steps:
      - checkout
      - run:
          name: Extract dependencies
          command: |
            grep "<PackageReference" circleci.csproj > nuget_packages.lock
            # grep "<DotNetCliToolReference" circleci.csproj >> nuget_packages.lock
      - restore_cache:
          key: v1-syncpanel-{{ checksum "nuget_packages.lock" }}
      - run:
          name: Build App
          command: |
            dotnet restore
            dotnet build
            echo hello
      - save_cache:
          key: v1-syncpanel-{{ checksum "nuget_packages.lock" }}
          paths:
            - ~/.nuget/packages
workflows:
  version: 2
  build:
    jobs:
      - build
